= Lab 1 - From Zero to Pushing Your First Application

== Target the Environment

. Follow the instructions to link:../README.adoc[Get Environment Access]

== Push It!

. This lab is not language specific so you can choose which sample project you would like. We will be letting PCF build the projects for us using buildpacks so you don't need to have your development machine configured for whichever language you choose.
+
----
$ cd $WORKSHOP_HOME/spring-cf-sample-app
----

. Push the application!
+
----
$ cf push
----
+
You should see output similar to the following listing. Language specific output has been omitted for clarity. Take a look at the listing callouts for a play-by-play of what's happening:
+
====
----
Pushing from manifest to org pivot-jmusselwhite / space playground as jmusselwhite@pivotal.io...
Using manifest file /Users/james/Code/PCF-101-Workshop/spring-cf-sample-app/manifest.yml <1>
Getting app info...
Creating app with these attributes...
+ name:        workshop <2>
  path:        /Users/james/Code/PCF-101-Workshop/spring-cf-sample-app/target/spring-cf-sample-app-0.0.1-SNAPSHOT.jar
+ instances:   1
+ memory:      1G
  env:
+   JAVA_OPTS
  routes:
+   workshop-noisy-bonobo.apps.pcfone.io <3>

Creating app workshop...
Mapping routes... <4>
Comparing local files to remote cache...
Packaging files to upload...
Uploading files... <5>
 770.60 KiB / 770.60 KiB [==========================================================================================================================================================================================================] 100.00% 2s

Waiting for API to complete processing files...

Staging app and tracing logs... <6>
   Downloading ibm_websphere_liberty_buildpack...
   Downloading meta_buildpack...
   Downloading nodejs_buildpack...
   Downloading java_buildpack_offline...
   Downloading ruby_buildpack...
   Downloaded ibm_websphere_liberty_buildpack
   Downloading go_buildpack...
   Downloaded nodejs_buildpack
   Downloading dotnet_core_buildpack...
   Downloaded java_buildpack_offline
   Downloading php_buildpack...
   Downloaded ruby_buildpack
   Downloading microgateway_decorator...
   Downloaded meta_buildpack
   Downloading staticfile_buildpack...
   Downloaded dotnet_core_buildpack
   Downloading binary_buildpack...
   Downloaded php_buildpack
   Downloading python_buildpack...
   Downloaded go_buildpack
   Downloaded staticfile_buildpack
   Downloaded microgateway_decorator
   Downloaded binary_buildpack
   Downloaded python_buildpack
   Cell 36dbde8c-7b2c-43b5-bf0f-92dbadb294d2 creating container for instance 5dc1a92e-7952-4dad-900a-774d5f807e37
   Cell 36dbde8c-7b2c-43b5-bf0f-92dbadb294d2 successfully created container for instance 5dc1a92e-7952-4dad-900a-774d5f807e37
   Downloading app package...
   Downloaded app package (26.7M)
   [meta-buildpack] /tmp/buildpacks/c442ba4296cffd72247b9f33e0d03a88/bin/detect not found
   [meta-buildpack] Compiling <7>
   ...
   omitted for clarity
   ...
   Exit status 0
   Uploading droplet, build artifacts cache...
   Uploading build artifacts cache...
   Uploading droplet...
   Uploaded build artifacts cache (132B)
   Uploaded droplet (73.9M) <8>
   Uploading complete
   Cell 36dbde8c-7b2c-43b5-bf0f-92dbadb294d2 stopping instance 5dc1a92e-7952-4dad-900a-774d5f807e37
   Cell 36dbde8c-7b2c-43b5-bf0f-92dbadb294d2 destroying container for instance 5dc1a92e-7952-4dad-900a-774d5f807e37
   Cell 36dbde8c-7b2c-43b5-bf0f-92dbadb294d2 successfully destroyed container for instance 5dc1a92e-7952-4dad-900a-774d5f807e37

Waiting for app to start...

name:                workshop-spring
requested state:     started
isolation segment:   iso-01
routes:              workshop-noisy-bonobo.apps.pcfone.io
last uploaded:       Tue 26 Mar 18:01:18 PDT 2019
stack:               cflinuxfs3
buildpacks:          omitted for clarity <9>

type:            web
instances:       1/1
memory usage:    1024M
start command:  omitted for clarity <9>
     state     since                  cpu    memory         disk           details
#0   running   2019-03-27T01:01:41Z   0.0%   197.9M of 1G   156.8M of 1G
<10>
----
<1> The CLI is using a manifest to provide necessary configuration details such as application name, memory to be allocated, and path to the application artifact.
Take a look at `manifest.yml` to see how.
<2> In most cases, the CLI indicates each Cloud Foundry API call as it happens.
In this case, the CLI has created an application record for _Workshop_ in your assigned space.
<3> All HTTP/HTTPS requests to applications will flow through Cloud Foundry's front-end router called http://docs.cloudfoundry.org/concepts/architecture/router.html[(Go)Router].
Here the CLI is creating a route with random word tokens inserted (again, see `manifest.yml` for a hint!) to prevent route collisions across the default domain.
<4> Now the CLI is _binding_ the created route to the application.
Routes can actually be bound to multiple applications to support techniques such as http://www.mattstine.com/2013/07/10/blue-green-deployments-on-cloudfoundry[blue-green deployments].
<5> The CLI finally uploads the application bits to Pivotal Cloud Foundry.
<6> Now we begin the staging process. The https://github.com/cloudfoundry/java-buildpack[Java Buildpack] is responsible for assembling the runtime components necessary to run the application.
<7> Here we see the version of the JRE that has been chosen and installed.
<8> The complete package of your application and all of its necessary runtime components is called a _droplet_.
Here the droplet is being uploaded to Pivotal Cloud Foundry's internal blobstore so that it can be easily copied to one or more _https://docs.cloudfoundry.org/concepts/diego/diego-architecture.html[Diego cells]_ for execution.
<9> The CLI tells you exactly what command and argument set was used to start your application.
<10> Finally the CLI reports the current status of your application's health.
====

. Visit the application in your browser by hitting the route that was generated by the CLI:
+
image::lab-java.png[]

== Interact with App from CF CLI

. Get information about the currently deployed application using CLI apps command:
+
----
$ cf apps
----
+
Note the application name for next steps

. Get information about running instances, memory, CPU, and other statistics using CLI instances command
+
----
$ cf app <<app_name>>
----

. Stop the deployed application using the CLI
+
----
$ cf stop <<app_name>>
----

. Delete the deployed application using the CLI
+
----
$ cf delete <<app_name>>
----

Congratulations! You have pushed your first app into Cloud Foundry!

== On to the next Lab!
link:lab-ruby.adoc[Lab1 - Push a Ruby Application]
